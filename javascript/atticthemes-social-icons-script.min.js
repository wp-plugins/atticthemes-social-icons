(function(f){f(".atticthemes-social-icon-sets-wrapper").on("click","li.atticthemes-social-icon-add-icon",b);function d(){f(".atticthemes-social-icon-sets-wrapper").off("dblclick","li.atsi",a);f(".atticthemes-social-icon-sets-wrapper").on("dblclick","li.atsi",a);}d();function a(){var m=f(this);var l=f(".atticthemes-social-icon-editor-wrapp");l.find(".atticthemes-social-icon-editor-title").text(m.attr("title"));var k=l.find("input.atticthemes-social-icon-link-input");k.val(decodeURI(m.attr("data-link")));setTimeout(function(){k.focus().select();},50);var n=l.find(".atticthemes-social-icon-editor-status-bar");n.text("");l.data("icon",m);l.fadeIn();k.off("keyup");k.on("keyup",function(o){o.preventDefault();if((o.keyCode||o.which)==13){l.find(".atticthemes-social-icon-editor-done-button").trigger("click");}else{if((o.keyCode||o.which)==27){l.find(".atticthemes-social-icon-editor-cancel-button").trigger("click");}}});}function b(){var n=f(this);var p=f(".atticthemes-social-icon-set-container").has(this);
var m=p.attr("data-set-id");var l=f(".atticthemes-social-icons-list-wrapp");l.fadeIn("fast");l.data("set_id",m);var o=f(".atticthemes-social-icons-list-close",l);o.one("click",k);function k(){l.fadeOut("fast");}}f(".atticthemes-social-icons-list").on("click","li",function(){var m=f(this);var p=m.clone().attr({"data-link":""});var l=f(".atticthemes-social-icons-list-wrapp");var n=l.data("set_id");var r=f('.atticthemes-social-icon-set-container[data-set-id="'+n+'"]');var o=f(".atticthemes-social-icon-add-icon",r);o.before(p);var k=l.find(".atticthemes-social-icons-list-preloader");k.fadeIn("fast");var q=r.hasClass("new-atticthemes-social-icon-set");r.removeClass("new-atticthemes-social-icon-set");if(q){c();}g(function(s){if(s.status==="success"||s.status==="no-change"){k.fadeOut({duration:200,complete:function(){console.log("icon added");}});}else{if(s.status==="error"){k.fadeOut({duration:200});f(".atticthemes-social-icons-list-status-bar").text(s.message);}}});});f(".atticthemes-social-icon-editor").on("click",".atticthemes-social-icon-editor-cancel-button",function(){var k=f(".atticthemes-social-icon-editor-wrapp");
k.fadeOut("fast");});f(".atticthemes-social-icon-editor").on("click",".atticthemes-social-icon-editor-done-button",function(){var m=f(".atticthemes-social-icon-editor-wrapp");var o=m.find("input.atticthemes-social-icon-link-input").val();var q=m.attr("data-icon-id");var l=m.data("icon");var n=m.find("button");n.attr("disabled",true);var k=m.find(".atticthemes-social-icon-editor-preloader");k.fadeIn("fast");var p=m.find(".atticthemes-social-icon-editor-status-bar");l.attr({"data-link":o});g(function(r){if(r.status==="success"||r.status==="no-change"){k.fadeOut({duration:200,complete:function(){m.fadeOut({complete:function(){n.removeAttr("disabled");}});if(o!==""){l.removeClass("no-link");}else{l.addClass("no-link");}}});}else{if(r.status==="error"){k.fadeOut({duration:200});f(".atticthemes-social-icon-set-id-editor-status-bar").text(r.message);}}});});f(".atticthemes-social-icon-set-container").each(function(){var k=f(this);j(k);e(k);});function j(k){f(".atticthemes-social-icon-set",k).sortable({connectWith:f(".atticthemes-social-icon-set-trash",k),items:"li:not(.placeholder):not(.atticthemes-social-icon-add-icon)",revert:true,placeholder:"ui-state-highlight",sort:function(){f(this).removeClass("ui-state-default");
},receive:function(l,m){var n=k.hasClass("new-atticthemes-social-icon-set");k.removeClass("new-atticthemes-social-icon-set");if(n){c();}d();},stop:function(){e(k);g();}}).disableSelection();f(".atticthemes-social-icon-set-trash",k).sortable({items:"li:not(.placeholder):not(.atticthemes-social-icon-set-dummy-icon)",revert:true,receive:function(l,m){m.item.fadeOut({duration:150,complete:function(){f(".atticthemes-social-icon-set-trash",k).empty();var n=f(".atticthemes-social-icon-set li",k).not("li.atticthemes-social-icon-add-icon").not("li.atticthemes-social-icon-set-dummy-icon");if(n.length===0){setTimeout(function(){k.slideUp().fadeOut({complete:function(){k.remove();}});},50);}}});},over:function(){f(".atticthemes-social-icon-set-trash",k).addClass("over-trash");},out:function(){f(".atticthemes-social-icon-set-trash",k).removeClass("over-trash");}});f(".atticthemes-social-icon-set-size",k).on("change",function(){e(k);g();});k.find(".atticthemes-social-icon-set-shortcode-text").click(function(){f(this).select();
});k.on("dblclick",".atticthemes-social-icon-set-shortcode-text",function(){if(f(".atticthemes-social-icon-set li",k).not(".atticthemes-social-icon-set-dummy-icon").length>0){h(k);}else{alert(atticthemes_social_icons.no_icons_in_set);}});}f(".atticthemes-social-icon-set-id-editor-cancel-button").on("click",function(){var k=f(".atticthemes-social-icon-set-id-editor-wrapp");k.fadeOut("fast");});f(".atticthemes-social-icon-set-id-editor-done-button").on("click",function(){var m=f(".atticthemes-social-icon-set-id-editor-wrapp");var n=m.attr("data-set-id");var o=f('.atticthemes-social-icon-set-container[data-set-id="'+n+'"]');var l=m.find("input.atticthemes-social-icon-set-id-link-input");var k=m.find(".atticthemes-social-icon-set-id-editor-preloader");k.fadeIn("fast");o.attr("data-set-id",l.val());g(function(p){if(p.status==="success"||p.status==="no-change"){f(".atticthemes-social-icon-set-shortcode-text",o).val("["+atticthemes_social_icons.shortcode_tag+' set="'+l.val()+'"]');k.fadeOut({duration:200,complete:function(){m.fadeOut("fast");
}});}else{if(p.status==="error"){k.fadeOut({duration:200});f(".atticthemes-social-icon-set-id-editor-status-bar").text(p.message);o.attr("data-set-id",n);}}});});function h(n){var l=f(".atticthemes-social-icon-set-id-editor-wrapp");var k=l.find("input.atticthemes-social-icon-set-id-link-input");k.val(n.attr("data-set-id"));var m=l.find(".atticthemes-social-icon-set-id-editor-status-bar");m.text("");setTimeout(function(){k.focus().select();},50);l.attr("data-set-id",n.attr("data-set-id"));l.fadeIn("fast");k.off("keyup");k.on("keyup",function(o){o.preventDefault();if((o.keyCode||o.which)==13){l.find(".atticthemes-social-icon-set-id-editor-done-button").trigger("click");}else{if((o.keyCode||o.which)==27){l.find(".atticthemes-social-icon-set-id-editor-cancel-button").trigger("click");}}});}function e(k){}function g(l){var k={};f(".atticthemes-social-icon-set-container").not(".new-atticthemes-social-icon-set").each(function(){var q=f(this);var o=[];var n="";var m=q.find(".atticthemes-social-icon-set>li").not("li.ui-state-highlight").not("li.atticthemes-social-icon-set-dummy-icon").not("li.atticthemes-social-icon-add-icon");
m.each(function(){o.push({id:f(this).attr("data-icon"),link:encodeURI(f(this).attr("data-link"))||null,});});n=f(".atticthemes-social-icon-set-size",q).val();var p=q.attr("data-set-id");k[p]={icons:o,size:n};});if(!f.isEmptyObject(k)){f.ajax({type:"post",dataType:"json",url:atticthemes_social_icons.ajax_url,data:{action:"atticthemes_social_icon_save_set",nonce:atticthemes_social_icons.ajax_nonce,data:btoa(JSON.stringify(k))},success:function(m){if(l){l(m);}},error:function(m,o,n){console.log("saveSets",m,o,n);}});}}function i(m){var p=f("<div/>").attr({"data-set-id":"icon-set-"+m}).addClass("atticthemes-social-icon-set-container new-atticthemes-social-icon-set");f("<ul/>").addClass("atticthemes-social-icon-set-trash").appendTo(p);var l=f("<ul/>").addClass("atticthemes-social-icon-set").appendTo(p);f("<li/>").addClass("atticthemes-social-icon-set-dummy-icon").appendTo(l);f("<li/>").addClass("atticthemes-social-icon-add-icon dashicons dashicons-plus").appendTo(l);var o=f("<div/>").addClass("atticthemes-social-icon-set-shortcode").appendTo(p);
var n=f("<input/>").attr({readonly:true,type:"text"}).addClass("atticthemes-social-icon-set-shortcode-text").appendTo(o);n.val("["+atticthemes_social_icons.shortcode_tag+' set="'+("icon-set-"+m)+'"]');var k=f("<select/>").addClass("atticthemes-social-icon-set-size").appendTo(o);if(window.atticthemes_social_icons&&atticthemes_social_icons.icon_sizes){f.each(atticthemes_social_icons.icon_sizes,function(q,r){f("<option/>").attr("value",r.size).text(r.name).appendTo(k);});}p.hide().appendTo(f(".atticthemes-social-icon-sets-wrapper")).fadeIn("fast");return p;}c(true);function c(k){f(".atticthemes-social-icons-set-preloader").fadeIn("fast");f.ajax({type:"post",dataType:"json",url:atticthemes_social_icons.ajax_url,data:{action:"atticthemes_social_icon_increment_ids",nonce:atticthemes_social_icons.ajax_nonce,increment:k===undefined?true:false},success:function(l){f(".atticthemes-social-icons-set-preloader").fadeOut({duration:150,complete:function(){var m=new i(l.ID?l.ID:0);j(m);}});},error:function(l,n,m){console.log("updateIDs",l,n,m);
}});}})(jQuery);